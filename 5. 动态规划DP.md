# çŠ¶æ€ä¸çŠ¶æ€è½¬ç§»

### ä¾‹1. æ•°å­—ä¸‰è§’å½¢: ç»™å‡ºä¸€ä¸ªæ•°å­—ä¸‰è§’å½¢, ä»é¡¶ç‚¹å‡ºå‘æ¯æ¬¡å‘ä¸‹æˆ–å‘å³ä¸‹èµ°ä¸€æ­¥, ç›´è‡³æœ€åº•å±‚, å°†é€”ç»çš„æ•°å­—ç›¸åŠ , å¾—åˆ°æœ€å¤§å€¼. å¦‚,
$$
\begin{matrix}
    7 \\
    3 & 8 \\
    8 & 1 & 0 \\
    2 & 7 & 4 & 4 \\
    4 & 5 & 2 & 6 & 5
\end{matrix}
$$
è§£ä¸º $7 \rightarrow 3 \rightarrow 8 \rightarrow 7 \rightarrow 5 = 30$.

> å®šä¹‰çŠ¶æ€ `dp[i][j]` ä¸ºä»ç¬¬ `1` è¡Œç¬¬ `1` åˆ—å‡ºå‘, èµ°åˆ°ç¬¬`i` è¡Œç¬¬ `j` åˆ—æ‰€æœ‰è·¯å¾„çš„æœ€å¤§å’Œ. æœ‰
> 
> `dp[i][j] = max(dp[i - 1][j - 1], dp[i - 1][j]) + matrix[i][j]`,
> 
> å…¶ä¸­, `dp[1][1] = matrix[1][1]` ä¸” $1 < i \leqslant n, 1 < j \leqslant i$. åˆ™æœ€ç»ˆç»“æœä¸º `dp[n][1...n]` çš„æœ€å¤§å€¼.

## çŠ¶æ€

æ˜ç¡®ä¸¤ç‚¹:

* åˆå§‹çŠ¶æ€. å¦‚åœ¨ä¾‹1ä¸­, åˆå§‹çŠ¶æ€ä¸º `dp[1][1] = matrix[1][1]`, `dp` å…¶ä½™å…ƒç´ åº”åˆå§‹åŒ–ä¸ºä¸€ä¸ªåˆé€‚çš„æœ€å°æ•°, å¦‚ `INT_MIN`.

* ç­”æ¡ˆé€‰å–ä½ç½®. å¦‚åœ¨ä¾‹1ä¸­, æœ€ç»ˆç»“æœä¸º `max(dp[n][1...n])`.

## çŠ¶æ€è½¬ç§»

* æ³¨æ„é¡ºåº, è¦ä¿è¯è½¬ç§»åˆ°å½“å‰çŠ¶æ€çš„åŸçŠ¶æ€å·²ç»å¤„ç†å®Œæ¯•.

### ä¾‹2. æœ€é•¿ä¸Šå‡å­åºåˆ—( $LIS$ )

ç»™å®šä¸€ä¸ªåºåˆ—, æ±‚å…¶ $LIS$. å­åºåˆ—å®šä¹‰: å°†åŸåºåˆ—åˆ é™¤ $0$ ~ $n$ ä¸ªå…ƒç´ æ‰€ç»„æˆçš„åºåˆ—. å­åºåˆ—ä¸ä¸€å®šæ˜¯è¿ç»­çš„å…ƒç´ .

> ä»¤ `dp[i]` è¡¨ç¤ºä»¥åŸåºåˆ—ä¸‹æ ‡ä¸º `i` ç»“å°¾çš„ä¸Šå‡å­åºåˆ—çš„æœ€é•¿é•¿åº¦. å–åˆå§‹çŠ¶æ€å¯¹æ‰€æœ‰ `i` æœ‰ `dp[i] = 1`, ç­”æ¡ˆä¸º `max(dp[0...n - 1])`.
>
> å¯¹ä¸‹æ ‡ä¸º `i` çš„å…ƒç´ , æœ‰ `j` ä» `0` è‡³ `i - 1` ä¾æ¬¡æ›´æ–°
>
> `dp[i] = nums[j] <= nums[i] ? max(dp[i], dp[j] + 1) : dp[i]`.

* [æœ€å¤§è¿ç»­å­åºåˆ—å’Œ](https://leetcode-cn.com/problems/maximum-subarray/)

* [æœ€é•¿å…¬å…±å­åºåˆ— ( $LCS$ )](https://leetcode-cn.com/problems/longest-common-subsequence/)

# èƒŒåŒ…é—®é¢˜

## è¯¦è§ [èƒŒåŒ…ä¹è®²](èƒŒåŒ…ä¹è®².pdf).

æœ¬èŠ‚ä»£ç æ‰€å¯¹åº”çš„é¢˜åœ¨[AcWing](https://www.acwing.com/problem/)ä¸Š.

### 1. 01èƒŒåŒ…é—®é¢˜

æœ´ç´ ç®—æ³•:
```c++
#include <bits/stdc++.h>
using namespace std;

const int MAXSIZE = 1005;
int N, V, dp[MAXSIZE][MAXSIZE], v[MAXSIZE], w[MAXSIZE];

int main()
{
    cin >> N >> V;
    for (int i = 1; i <= N; i++)
        cin >> v[i] >> w[i];

    for (int i = 1; i <= N; i++)
    {
        for (int j = 1; j <= V; j++)
        {
            if (j < v[i])
                dp[i][j] = dp[i - 1][j];
            else
                dp[i][j] = max(dp[i - 1][j], dp[i - 1][j - v[i]] + w[i]);
        }
    }
    
    int res = 0;
    for (int j = 1; j <= V; j++)
        res = max(res, dp[N][j]);
    cout << res;

    return 0;
}
```

ä¼˜åŒ–ç©ºé—´å¤æ‚åº¦:
```c++
#include <bits/stdc++.h>
using namespace std;

const int MAXSIZE = 1005;
int N, V, dp[MAXSIZE], v[MAXSIZE], w[MAXSIZE];

int main()
{
    cin >> N >> V;
    for (int i = 1; i <= N; i++)
        cin >> v[i] >> w[i];

    for (int i = 1; i <= N; i++)
        for (int j = V; j >= v[i]; j--)
            dp[j] = max(dp[j], dp[j - v[i]] + w[i]);

    cout << dp[V];

    return 0;
}
```

### 2. å®Œå…¨èƒŒåŒ…é—®é¢˜

```c++
#include <bits/stdc++.h>
using namespace std;

const int MAXSIZE = 1005;
int N, V, v[MAXSIZE], w[MAXSIZE], dp[MAXSIZE];

int main()
{
    cin >> N >> V;
    for (int i = 1; i <= N; i++)
        cin >> v[i] >> w[i];

    for (int i = 1; i <= N; i++)
        for (int j = v[i]; j <= V; j++)
            dp[j] = max(dp[j], dp[j - v[i]] + w[i]);

    cout << dp[V];

    return 0;
}
```

### 3. å¤šé‡èƒŒåŒ…é—®é¢˜

* æœ´ç´ ç®—æ³•
  
    ```c++
    #include <bits/stdc++.h>
    using namespace std;

    const int MAXSIZE = 1005;
    int N, V, dp[MAXSIZE];

    int main()
    {
        cin >> N >> V;
        int v, w, s;
        for (int i = 1; i <= N; i++)
        {
            cin >> v >> w >> s;
            for (int j = V; j >= v; j--)
                for (int k = 1; k <= s && k * v <= j; k++)
                    dp[j] = max(dp[j], dp[j - k * v] + k * w);
        }

        cout << dp[V];

        return 0;
    }
    ```

* äºŒè¿›åˆ¶ä¼˜åŒ–
    ```c++
    #include <bits/stdc++.h>
    using namespace std;

    const int MAXSIZE = 2005;
    int N, V, dp[MAXSIZE];

    int main()
    {
        cin >> N >> V;
        int v, w, s;
        for (int i = 1; i <= N; i++)
        {
            cin >> v >> w >> s;
            /*
             * å½“å‰ç‰©å“æ•°é‡è¶³å¤Ÿå°†èƒŒåŒ…è£…åˆ°ä¸èƒ½å†è£…æ­¤ç‰©å“, ä¸ºå®Œå…¨èƒŒåŒ…é—®é¢˜ 
            **/
            if (s * v >= V)
            {
                for (int j = v; j <= V; j++)
                    dp[j] = max(dp[j], dp[j - v] + w);
            }
            /*
             * å½“å‰ç‰©å“å…¨éƒ¨è£…å…¥å, èƒŒåŒ…å®¹é‡è¿˜å¯ç»§ç»­è£…å½“å‰ç‰©å“,
             * ä¸ºå¤šé‡èƒŒåŒ…é—®é¢˜, äºŒè¿›åˆ¶ä¼˜åŒ–ä¸ºå¤šä¸ª01èƒŒåŒ…é—®é¢˜
            **/
            else
            {
                for (int k = 1; k < s; k <<= 1)
                {
                    for (int j = V; j >= k * v; j--)
                        dp[j] = max(dp[j], dp[j - k * v] + k * w);
                    s -= k;
                }
                for (int j = V; j >= s * v; j--)
                    dp[j] = max(dp[j], dp[j - s * v] + s * w);
            }
        }

        cout << dp[V];

        return 0;
    }
    ```

* å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–*
  
  é¢„å¤‡çŸ¥è¯†: æ»‘åŠ¨çª—å£ä¸å•è°ƒé˜Ÿåˆ—, ä¾‹ğŸ”—[LeetCode-239. Sliding Window Maximum](https://leetcode-cn.com/problems/sliding-window-maximum/)
  
    ```c++
    #include <bits/stdc++.h>
    using namespace std;

    const int MAXSIZE = 20005;
    int N, V, dp[MAXSIZE], g[MAXSIZE], q[MAXSIZE];

    int main()
    {
        cin >> N >> V;
        int v, w, s;
        for (int i = 1; i <= N; i++)
        {
            cin >> v >> w >> s;
            memcpy(g, dp, sizeof(dp));

            /*
            * å¯¹äºä»»æ„ä¸€ç§ç‰©å“è€Œè¨€, å…¶ä¸€å®šæ˜¯ä»¥ v ä¸ªå®¹é‡æ”¾å…¥èƒŒåŒ…çš„. å› æ­¤,
            * å¯¹äºä»»æ„çŠ¶æ€ä¸‹çš„å·²å ç”¨å®¹é‡, éƒ½å¯ä»¥åˆ†æˆæ¨¡ v çš„ä½™æ•°, å³ v ç±»æƒ…å†µ.
            * æ­¤æ—¶å¯¹äºä»»æ„çš„ j, åªéœ€è¦å‘ v çš„å€æ•°è½¬ç§».
            **/
            for (int j = 0; j < v; j++)
            {
                /*
                * front æŒ‡å‘é˜Ÿé¦–, rear æŒ‡å‘é˜Ÿå°¾, front > rear æ—¶è¡¨ç¤ºé˜Ÿç©º.
                * q ä¸ºå•è°ƒé˜Ÿåˆ—, ç”¨äºç»´æŠ¤æ»‘åŠ¨çª—å£ä¸­çš„æœ€å¤§å€¼çš„æ•°ç»„ä¸‹æ ‡.
                * v çš„ä¸ªæ•° = (ä¸‹æ ‡ - ä½™æ•°) / v = (q[front] - j) / v.
                * ä»·å€¼ = v * w = (k - j) / v * w.
                **/
                int front = 0, rear = -1;
                for (int k = j; k <= V; k += v)
                {
                    dp[k] = g[k];
                    // è‹¥å½“å‰çª—å£çš„å†…å®¹è¶…è¿‡äº† s ä¸ª (k - q[front] > s * v)
                    if (front <= rear && k - s * v > q[front])
                        front++;
                    
                    /*
                     * dp[k] = max(i - 1 çš„ dp[k], i - 1 çš„ dp ä¸­èƒ½
                     * è½¬ç§»çš„æœ€å¤§ + å¯ä»¥è£…å…¥çš„ä¸ªæ•° * å•ä¸ªä»·å€¼)
                    **/
                    if (front <= rear)
                        dp[k] = max(dp[k], g[q[front]] + (k - q[front]) / v * w);
                    while (front <= rear && g[q[rear]] - (q[rear] - j) / v * w <= g[k] - (k - j) / v * w)
                        rear--;
                    q[++rear] = k;
                }
            }
        }

        cout << dp[V];

        return 0;
    }
    ```

* å°ç»“*
  
  å¯¹äºå¤šé‡èƒŒåŒ…é—®é¢˜, å…¶å’Œå®Œå…¨èƒŒåŒ…é—®é¢˜çš„ä¸åŒä¹‹å¤„åœ¨äº, å®Œå…¨èƒŒåŒ…é—®é¢˜ä¸é™åˆ¶åŒä¸€ç§ç‰©å“æ”¾çš„ä¸ªæ•°, è€Œåœ¨å¤šé‡èƒŒåŒ…é—®é¢˜ä¸­, æ¯ç§ç‰©å“çš„ä¸ªæ•° $s_i$ å¯èƒ½ä¼šé™åˆ¶å…¶è½¬ç§»çš„çŠ¶æ€æ•°, å³å½“å‰æ”¾å…¥åçš„å®¹é‡ä¸æ­¤å®¹é‡çš„å‰ä¸€ä¸ªçŠ¶æ€ä¹‹å·®ä¸å½“å‰æ”¾å…¥çš„è¿™ç§ç‰©å“çš„ä½“ç§¯(èŠ±è´¹)ä¹‹æ¯”ä¸èƒ½è¶…è¿‡ $s_i$, å¦åˆ™æ˜¯æ— æ•ˆçš„è½¬ç§».

  å½“ $s_i$ é™åˆ¶è½¬ç§»çš„çŠ¶æ€æ—¶, åœ¨è½¬ç§»çš„è¿‡ç¨‹ä¸­ç›¸å½“äºå­˜åœ¨ä¸€ä¸ªå¤§å°ä¸º $s_i$ çš„æ»‘åŠ¨çª—å£. æ•…æ¯æ¬¡è¦å°†ä¹‹å‰çš„å€¼, ä¸æ»‘åŠ¨çª—å£ä¸­çš„æœ€å¤§å€¼æ¯”è¾ƒ, è€Œéä¸æ‰€æœ‰è½¬ç§»çš„æœ€å¤§å€¼æ¯”è¾ƒ.


### 4. æ··åˆä¸‰ç§èƒŒåŒ…é—®é¢˜

å°†å‰é¢çš„1ã€2ã€3ä¸­çš„ä¸‰ç§èƒŒåŒ…é—®é¢˜æ··åˆèµ·æ¥, å³æœ‰çš„ç‰©å“åªå¯ä»¥å–ä¸€æ¬¡(01èƒŒåŒ…), æœ‰çš„ç‰©å“å¯ä»¥å–æ— é™æ¬¡(å®Œå…¨èƒŒåŒ…), æœ‰çš„ç‰©å“å–å¾—æ¬¡æ•°æœ‰ä¸€ä¸ªä¸Šé™(å¤šé‡èƒŒåŒ…). è§£å†³è¿™æ ·çš„é—®é¢˜, åªéœ€è¦å¯¹æ¯ä¸€ç§ç‰©å“æ‰€å±çš„é—®é¢˜è¿›è¡Œåˆ¤æ–­. ä¼ªä»£ç è§ä¸‹:

```c++
for (int i = 0; i <= N; i++)
{
    if (ç¬¬iä»¶ç‰©å“å±äº01èƒŒåŒ…)
        ZeroOnePack(F, c[i], w[i]);
    else if (ç¬¬iä»¶ç‰©å“å±äºå®Œå…¨èƒŒåŒ…)
        CompletePack(F, c[i], w[i]);
    else if (ç¬¬iä»¶ç‰©å“å±äºå¤šé‡èƒŒåŒ…)
        MultiplePack(F, c[i], w[i], s[i]);
}
```

[é¢˜](https://www.acwing.com/problem/content/7/)è§£å¦‚ä¸‹:

```c++
#include <bits/stdc++.h>
using namespace std;

const int MAXSIZE = 1005;
int N, V, dp[MAXSIZE];

void ZeroOnePack(int v, int w)
{
    for (int j = V; j >= v; j--)
        dp[j] = max(dp[j], dp[j - v] + w);
}

void CompletePack(int v, int w)
{
    for (int j = v; j <= V; j++)
        dp[j] = max(dp[j], dp[j - v] + w);
}

void MultiplePack(int v, int w, int s)
{
    if (s * v >= V)
        CompletePack(v, w);
    else
    {
        for (int k = 1; k < s; k <<= 1)
        {
            ZeroOnePack(k * v, k * w);
            s -= k;
        }
        ZeroOnePack(s * v, s * w);
    }
}

void MixedPack(int v, int w, int s)
{
    if (s == -1)
        ZeroOnePack(v, w);
    else if (s == 0)
        CompletePack(v, w);
    else if (s > 0)
        MultiplePack(v, w, s);
}

int main()
{
    cin >> N >> V;

    int v, w, s;
    for (int i = 1; i <= N; i++)
    {
        cin >> v >> w >> s;
        MixedPack(v, w, s);
    }
    cout << dp[V];

    return 0;
}
```

### 5. äºŒç»´è´¹ç”¨çš„èƒŒåŒ…é—®é¢˜

```c++
#include <bits/stdc++.h>
using namespace std;

const int MAXSIZE = 110;
int N, V, M, dp[MAXSIZE][MAXSIZE];

void ZeroOnePack(int v, int m, int w)
{
    for (int j = V; j >= v; j--)
        for (int k = M; k >= m; k--)
            dp[j][k] = max(dp[j][k], dp[j - v][k - m] + w);
}

int main()
{
    cin >> N >> V >> M;
    int v, m, w;
    for (int i = 1; i <= N; i++)
    {
        cin >> v >> m >> w;
        ZeroOnePack(v, m, w);
    }
    cout << dp[V][M];

    return 0;
}
```

### 6. åˆ†ç»„èƒŒåŒ…é—®é¢˜

```c++
#include <bits/stdc++.h>
using namespace std;

const int MAXSIZE = 110;
int N, V, v[MAXSIZE], w[MAXSIZE], dp[MAXSIZE];


int main()
{
    cin >> N >> V;
    for (int i = 1; i <= N; i++)
    {
        int S;
        cin >> S;
        for (int j = 1; j <= S; j++)
            cin >> v[j] >> w[j];

        for (int k = V; k >= 0; k--)
            for (int j = 1; j <= S; j++)
                if (k - v[j] >= 0)
                    dp[k] = max(dp[k], dp[k - v[j]] + w[j]);
    }
    cout << dp[V];

    return 0;
}
```

### 7. æœ‰ä¾èµ–çš„èƒŒåŒ…é—®é¢˜

```c++
#include <bits/stdc++.h>
using namespace std;

const int MAXSIZE = 110;
struct good {
    int v, w;
    vector<int> children;
} goods[MAXSIZE];
int N, V, dp[MAXSIZE][MAXSIZE];

void dfs(int root)
{
    // å› ä¸ºæœ‰ä¾èµ–å…³ç³», æ¯æ¬¡è°ƒç”¨ dfs å‡½æ•°éœ€è¦åˆå§‹åŒ– dp çš„ç›¸åº”éƒ¨åˆ†
    for (int i = goods[root].v; i <= V; i++)
        dp[root][i] = goods[root].w;

    for (int child : goods[root].children)
    {
        dfs(child);
        /*
         * åˆ†ç»„èƒŒåŒ…, è¿™é‡Œç”±äºä¾èµ–å…³ç³»æœ‰ j <- V ~ goods[root].v, å³å·²ç»
         * é€‰æ‹©äº†å½“å‰å­©å­çš„çˆ¶ç»“ç‚¹, è‡³å°‘å ç”¨äº† goods[root].v, æ•…éä¸º V ~ 0.
        **/
        for (int j = V; j >= goods[root].v; j--)
            for (int k = 0; k <= j - goods[root].v; k++)
                dp[root][j] = max(dp[root][j], dp[root][j - k] + dp[child][k]);
    }
}

int main()
{
    cin >> N >> V;
    int root;
    for (int i = 1; i <= N; i++)
    {
        int father;
        cin >> goods[i].v >> goods[i].w >> father;
        if (father == -1)
            root = i;
        else
            goods[father].children.push_back(i);
    }
    dfs(root);
    cout << dp[root][V];

    return 0;
}
```

### 8. èƒŒåŒ…é—®é¢˜æœ€ä¼˜é€‰æ³•æ–¹æ¡ˆæ•°

```c++
#include <bits/stdc++.h>
using namespace std;

const int MAXSIZE = 1010;
const int MOD = 1e9 + 7;
int N, V, dp[MAXSIZE], cnt[MAXSIZE];

int main()
{
    cin >> N >> V;
    fill(dp + 1, dp + V + 1, INT_MIN);
    cnt[0] = 1;
    int v, w;
    for (int i = 1; i <= N; i++)
    {
        cin >> v >> w;
        for (int j = V; j >= v; j--)
        {
            int temp = max(dp[j], dp[j - v] + w), s = 0;
            if (temp == dp[j])
                s += cnt[j];
            if (temp == dp[j - v] + w)
                s += cnt[j - v];
            dp[j] = temp;
            cnt[j] = s % MOD;
        }
    }

    int maxW = 0, res = 0;
    for (int i = 0; i <= V; i++)
        maxW = max(maxW, dp[i]);
    for (int i = 0; i <= V; i++)
        if (dp[i] == maxW)
            res = (res + cnt[i]) % MOD;
    cout << res;

    return 0;
}
```

### 9. æ±‚èƒŒåŒ…é—®é¢˜å…·ä½“æ–¹æ¡ˆ

```c++
#include <bits/stdc++.h>
using namespace std;

const int MAXSIZE = 1010;
int N, V, v[MAXSIZE], w[MAXSIZE], dp[MAXSIZE][MAXSIZE];

int main()
{
    cin >> N >> V;
    for (int i = 1; i <= N; i++)
        cin >> v[i] >> w[i];

    for (int i = N; i >= 1; i--)
    {
        for (int j = 0; j <= V; j++)
        {
            dp[i][j] = dp[i + 1][j];
            if (j >= v[i])
                dp[i][j] = max(dp[i][j], dp[i + 1][j - v[i]] + w[i]);
        }
    }

    int volume = V;
    for (int i = 1; i <= N; i++)
    {
        if (volume >= v[i] && dp[i][volume] == dp[i + 1][volume - v[i]] + w[i])
        {
            cout << i << " ";
            volume -= v[i];
        }
    }

    return 0;
}
```